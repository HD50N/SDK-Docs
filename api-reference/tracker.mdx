---
title: 'HumanBehaviorTracker API'
description: 'Complete API reference for the HumanBehaviorTracker class'
---

# HumanBehaviorTracker API

The `HumanBehaviorTracker` class is the main entry point for the HumanBehavior SDK. It handles session recording, user identification, and event tracking.

## Constructor

### `new HumanBehaviorTracker(apiKey, ingestionUrl)`

Creates a new tracker instance.

**Parameters:**
- `apiKey` (string, required): Your HumanBehavior API key
- `ingestionUrl` (string, required): Your ingestion server URL

**Returns:** `HumanBehaviorTracker` instance

**Example:**
```javascript
import { HumanBehaviorTracker } from 'humanbehavior-js';

const tracker = new HumanBehaviorTracker(
  'your-api-key-here',
  'https://ingestion.humanbehavior.ai'
);
```

**Throws:**
- `Error`: If API key or ingestion URL is not provided

## Core Methods

### `start()`

Starts session recording and begins capturing user interactions.

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.start();
```

**Notes:**
- Automatically initializes the tracker if not already initialized
- Begins recording DOM events, mouse movements, and user interactions
- Sets up automatic event batching and transmission

### `stop()`

Stops session recording but keeps the session alive.

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.stop();
```

**Notes:**
- Stops recording new events
- Keeps the current session active
- Can be resumed with `start()`

## User Management

### `addUserInfo(userProperties)`

Adds or updates user information for the current session.

**Parameters:**
- `userProperties` (object, required): User properties to track

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.addUserInfo({
  email: 'user@example.com',
  name: 'John Doe',
  userId: '12345',
  plan: 'premium'
});
```

**Notes:**
- User information is automatically associated with all future events
- Can be called multiple times to update user data
- Requires tracker to be initialized

### `auth(authFields)`

Authenticates the current user against your database.

**Parameters:**
- `authFields` (string[], required): Array of field names to use for authentication

**Returns:** `Promise<void>`

**Example:**
```javascript
// First add user info
await tracker.addUserInfo({
  email: 'user@example.com',
  phone: '+1234567890'
});

// Then authenticate
await tracker.auth(['email', 'phone']);
```

**Notes:**
- Must be called after `addUserInfo()`
- Uses the provided fields to match against existing users
- Requires tracker to be initialized

## Event Tracking

### `customEvent(eventName, properties)`

Tracks a custom event with optional properties.

**Parameters:**
- `eventName` (string, required): Name of the event
- `properties` (object, optional): Event properties

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.customEvent('button_click', {
  buttonId: 'submit-form',
  page: '/checkout',
  timestamp: Date.now()
});
```

**Notes:**
- Event is automatically associated with current user and session
- Properties can include any serializable data
- Event is sent immediately to the ingestion server

### `addEvent(event)`

Adds a raw event to the session recording.

**Parameters:**
- `event` (object, required): Raw event object

**Returns:** `Promise<void>`

**Example:**
```javascript
tracker.addEvent({
  type: 'custom',
  data: { action: 'test' },
  timestamp: Date.now()
});
```

**Notes:**
- Used internally by the SDK
- Generally not needed for normal usage
- Events are automatically batched and sent

## Data Redaction

### `setRedactedFields(fields)`

Sets the fields that should be redacted during recording.

**Parameters:**
- `fields` (string[], required): Array of CSS selectors for fields to redact

**Returns:** `void`

**Example:**
```javascript
tracker.setRedactedFields([
  'input[type="password"]',
  'input[type="email"]',
  '.sensitive-data'
]);
```

**Notes:**
- Fields are redacted in real-time during recording
- Can be called multiple times to update redaction rules
- Only user-selected fields are redacted (no automatic redaction)

### `isRedactionActive()`

Checks if redaction is currently active.

**Returns:** `boolean`

**Example:**
```javascript
const isActive = tracker.isRedactionActive();
console.log('Redaction active:', isActive);
```

### `getRedactedFields()`

Gets the current list of redacted fields.

**Returns:** `string[]`

**Example:**
```javascript
const fields = tracker.getRedactedFields();
console.log('Redacted fields:', fields);
```

### `redact(options)`

Starts redaction functionality with optional configuration.

**Parameters:**
- `options` (RedactionOptions, optional): Configuration for redaction behavior

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.redact({
  redactedText: '[REDACTED]',
  excludeSelectors: ['.no-redact'],
  userFields: ['input[type="password"]']
});
```

## Debugging

### `viewLogs()`

Displays all SDK logs in the console.

**Returns:** `void`

**Example:**
```javascript
tracker.viewLogs();
```

**Notes:**
- Logs include session events, user identification, and errors
- Logs are stored in localStorage
- Calling this method clears the logs

### `logToStorage(message)`

Logs a message to storage for debugging.

**Parameters:**
- `message` (string, required): Message to log

**Returns:** `void`

**Example:**
```javascript
HumanBehaviorTracker.logToStorage('Custom debug message');
```

**Notes:**
- Static method
- Messages are stored in localStorage
- Can be viewed with `viewLogs()`

## Properties

### `initializationPromise`

Promise that resolves when the tracker is fully initialized.

**Type:** `Promise<void> | null`

**Example:**
```javascript
await tracker.initializationPromise;
console.log('Tracker initialized');
```

## Error Handling

### Common Errors

```javascript
// Error: API key not provided
const tracker = new HumanBehaviorTracker(); // Throws error

// Error: Ingestion URL not provided
const tracker = new HumanBehaviorTracker('api-key'); // Throws error

// Error: Tracker not initialized
await tracker.addUserInfo({}); // Throws error if not initialized

// Error: No user info available
await tracker.auth(['email']); // Throws error if addUserInfo not called first
```

### Error Handling Example

```javascript
try {
  await tracker.addUserInfo({
    email: 'user@example.com'
  });
} catch (error) {
  console.error('Failed to add user info:', error);
  // Handle error appropriately
}
```

## Lifecycle

### Initialization Flow

1. **Constructor**: Creates tracker instance
2. **Automatic Initialization**: Begins when instance is created
3. **API Call**: Sends initialization request to server
4. **Cookie Setup**: Sets up user identification cookies
5. **Ready State**: Tracker is ready for use

### Session Flow

1. **Start**: Begin recording user interactions
2. **Event Capture**: Automatically capture DOM, mouse, and input events
3. **Batching**: Events are batched for efficient transmission
4. **Transmission**: Events are sent to ingestion server
5. **Stop**: Stop recording (optional)

## Performance Considerations

### Event Batching

Events are automatically batched and sent every 5 seconds:

```javascript
// Events are batched automatically
tracker.customEvent('event1', { data: 'value1' });
tracker.customEvent('event2', { data: 'value2' });
tracker.customEvent('event3', { data: 'value3' });
// All events sent together after 5 seconds
```

### Memory Management

The SDK automatically manages memory:

- Events are cleared after successful transmission
- Failed events are retried automatically
- Session data is cleaned up when sessions end

## Browser Compatibility

The SDK supports all modern browsers:

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

<Note>
  The tracker automatically handles browser compatibility and falls back gracefully for unsupported features.
</Note>

<Warning>
  Always ensure you have user consent before starting session recording, especially in regions with strict privacy laws.
</Warning> 