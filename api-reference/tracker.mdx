---
title: 'HumanBehaviorTracker API'
description: 'Complete API reference for the HumanBehaviorTracker class'
---

# HumanBehaviorTracker API

The `HumanBehaviorTracker` class is the main entry point for the HumanBehavior SDK. It handles session recording, user identification, and event tracking.

## Constructor

### `new HumanBehaviorTracker(apiKey, ingestionUrl?)`

Creates a new tracker instance.

**Parameters:**
- `apiKey` (string, required): Your HumanBehavior API key
- `ingestionUrl` (string, optional): Your custom ingestion server URL

**Returns:** `HumanBehaviorTracker` instance

**Example:**
```javascript
import { HumanBehaviorTracker } from 'humanbehavior-js';

// Use default ingestion server
const tracker = new HumanBehaviorTracker('your-api-key-here');

// Use custom ingestion server
const tracker = new HumanBehaviorTracker(
  'your-api-key-here',
  'https://your-custom-server.com'
);
```

**Throws:**
- `Error`: If API key is not provided

## Core Methods

### `start()`

Starts session recording and begins capturing user interactions.

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.start();
```

**Notes:**
- Automatically initializes the tracker if not already initialized
- Begins recording DOM events, mouse movements, and user interactions
- Sets up automatic event batching and transmission
- Captures entry URL and referrer information

### `stop()`

Stops session recording but keeps the session alive.

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.stop();
```

**Notes:**
- Stops recording new events
- Keeps the current session active
- Can be resumed with `start()`

## User Management

### `addUserInfo(userProperties)`

Adds or updates user information for the current session.

**Parameters:**
- `userProperties` (object, required): User properties to track

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.addUserInfo({
  email: 'user@example.com',
  name: 'John Doe',
  userId: '12345',
  plan: 'premium'
});
```

**Notes:**
- User information is automatically associated with all future events
- Can be called multiple times to update user data
- Requires tracker to be initialized

### `auth(authFields)`

Authenticates the current user against your database.

**Parameters:**
- `authFields` (string[], required): Array of field names to use for authentication

**Returns:** `Promise<void>`

**Example:**
```javascript
// First add user info
await tracker.addUserInfo({
  email: 'user@example.com',
  phone: '+1234567890'
});

// Then authenticate
await tracker.auth(['email', 'phone']);
```

**Notes:**
- Must be called after `addUserInfo()`
- Uses the provided fields to match against existing users
- Requires tracker to be initialized

## Event Tracking

### `customEvent(eventName, properties)`

Tracks a custom event with optional properties.

**Parameters:**
- `eventName` (string, required): Name of the event
- `properties` (object, optional): Event properties

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.customEvent('button_click', {
  buttonId: 'submit-form',
  page: '/checkout',
  timestamp: Date.now()
});
```

**Notes:**
- Event is automatically associated with current user and session
- Properties can include any serializable data
- Event is sent immediately to the ingestion server

### `addEvent(event)`

Adds a raw event to the session recording.

**Parameters:**
- `event` (object, required): Raw event object

**Returns:** `Promise<void>`

**Example:**
```javascript
tracker.addEvent({
  type: 'custom',
  data: { action: 'test' },
  timestamp: Date.now()
});
```

**Notes:**
- Used internally by the SDK
- Generally not needed for normal usage
- Events are automatically batched and sent

## Data Redaction

### `setRedactedFields(fields)`

Sets the fields that should be redacted during recording.

**Parameters:**
- `fields` (string[], required): Array of CSS selectors for fields to redact

**Returns:** `void`

**Example:**
```javascript
tracker.setRedactedFields([
  'input[type="password"]',
  'input[type="email"]',
  '.sensitive-data'
]);
```

**Notes:**
- Fields are redacted in real-time during recording
- Can be called multiple times to update redaction rules
- Only user-selected fields are redacted (no automatic redaction)

### `isRedactionActive()`

Checks if redaction is currently active.

**Returns:** `boolean`

**Example:**
```javascript
const isActive = tracker.isRedactionActive();
console.log('Redaction active:', isActive);
```

**Notes:**
- Returns `true` if any fields are set for redaction
- Returns `false` if no fields are redacted

### `getRedactedFields()`

Gets the currently selected fields for redaction.

**Returns:** `string[]`

**Example:**
```javascript
const fields = tracker.getRedactedFields();
console.log('Redacted fields:', fields);
```

**Notes:**
- Returns array of CSS selectors currently set for redaction
- Returns empty array if no redaction is configured

### `redact(options)`

Configures redaction with custom options.

**Parameters:**
- `options` (object, optional): Redaction configuration options
  - `redactedText` (string, optional): Custom text to use for redaction
  - `excludeSelectors` (string[], optional): Selectors to exclude from redaction
  - `userFields` (string[], optional): Fields to redact

**Returns:** `Promise<void>`

**Example:**
```javascript
await tracker.redact({
  redactedText: '[HIDDEN]',
  excludeSelectors: ['.public-data'],
  userFields: ['input[type="password"]']
});
```

## Debug and Logging

### `viewLogs()`

Displays SDK logs in the browser console.

**Returns:** `void`

**Example:**
```javascript
tracker.viewLogs();
```

**Notes:**
- Shows logs from the current session
- Clears logs after displaying them
- Useful for debugging and troubleshooting

### `logToStorage(message)`

Logs a message to local storage for debugging.

**Parameters:**
- `message` (string, required): Message to log

**Returns:** `void`

**Example:**
```javascript
HumanBehaviorTracker.logToStorage('Custom debug message');
```

**Notes:**
- Static method for logging messages
- Messages are stored in localStorage
- Can be viewed with `viewLogs()`

## Properties

### `initializationPromise`

Promise that resolves when the tracker is fully initialized.

**Type:** `Promise<void> | null`

**Example:**
```javascript
// Wait for initialization
await tracker.initializationPromise;
console.log('Tracker initialized');
```

**Notes:**
- `null` if initialization failed
- Resolves when tracker is ready to use
- Rejects if initialization fails

## Session Management

### Session Persistence

Sessions automatically persist for 30 minutes of inactivity:

```javascript
// Session continues across:
// - Page refreshes
// - Tab switching
// - Short periods of inactivity

// New session created after:
// - 30+ minutes of inactivity
// - Manual session reset
```

### URL Tracking

The SDK automatically tracks URL information:

```javascript
// Entry URL captured when session starts
// All URL changes tracked during session
// End URL captured when session completes
// Referrer information included
```

## Error Handling

### Common Errors

**Initialization Errors:**
```javascript
try {
  const tracker = new HumanBehaviorTracker('invalid-key');
  await tracker.start();
} catch (error) {
  console.error('Initialization failed:', error.message);
}
```

**Method Call Errors:**
```javascript
try {
  await tracker.addUserInfo({ email: 'test@example.com' });
} catch (error) {
  console.error('Failed to add user info:', error.message);
}
```

### Error Recovery

The SDK includes automatic error recovery:

- Failed network requests are retried
- Events are queued during network issues
- Session data is preserved during errors
- Automatic reconnection to ingestion server

## Performance Considerations

### Event Batching

Events are automatically batched for efficiency:

- Events are collected in memory
- Batches are sent every 5 seconds
- Large events are chunked automatically
- Failed batches are retried

### Memory Management

The SDK manages memory efficiently:

- Events are cleared after successful transmission
- Session data is limited to prevent memory leaks
- Automatic cleanup of old data
- Garbage collection friendly

<Note>
  **Version 0.0.8**: Enhanced URL tracking, improved session management, and better error handling. The SDK now automatically captures entry URLs, navigation paths, and end URLs for comprehensive session analysis.
</Note>

## Browser Compatibility

The SDK supports all modern browsers:

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

<Note>
  The tracker automatically handles browser compatibility and falls back gracefully for unsupported features.
</Note>

<Warning>
  Always ensure you have user consent before starting session recording, especially in regions with strict privacy laws.
</Warning> 